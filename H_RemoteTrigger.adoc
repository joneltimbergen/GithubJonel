:numbered:
:toc: macro

= OCPP 1.X: H. Remote Trigger
v0.6 DRAFT, 2016-08-01
:title-logo-image: ../media/logo.png

Copyright © 2010 – 2016 Open Charge Alliance. All rights reserved.

This document is made available under the _*Creative Commons Attribution-NoDerivatives 4.0 International Public License*_ (https://creativecommons.org/licenses/by-nd/4.0/legalcode).

*Version History*

[cols="2,3,4,6",options="header",]
|=======================================================================
|*Version* |*Date* |*Author* |*Description*


|0.8
|2017-02-03
|Paul Klapwijk +
_ElaadNL_ +
|Minor changes for OCPP missing texts.

|0.7
|2016-11-10
|Jonel Timbergen +
_ElaadNL_ +
|RC3. Deleted link to test cases, after comments made within the OASIS OCPP TC.

|0.6
|2016-08-01
|Jonel Timbergen +
_ElaadNL_ +
|RC2. Changes due to first comments by Technical Working Group.

|0.4
|2016-06-09
|Jonel Timbergen +
_ElaadNL_ +
|RC1. Changes due to first comments by Technical Working Group.


|0.3
|2016-04-20
|Jonel Timbergen +
_ElaadNL_ +
Robert de Leeuw +
_IHomer_ +
|RC1. First draft release of OCPP1.6 in new document structure.

|0.2
|2016-04-11
|Jonel Timbergen +
_ElaadNL_ +
|Implemented comments by Robert de Leeuw.

|0.15
|2016-03-24
|Jonel Timbergen +
_ElaadNL_ +
| Finalized the other use cases.

|0.1
|2016-03-23
|Jonel Timbergen +
_ElaadNL_ +
|Added the first use case.

|=======================================================================

<<<
[[introduction]]
== Introduction

This functional block describes all the remote trigger functionality of OCPP. This functionality enables remote triggering of messages. For example, requesting messages to be resend or request current status of some ongoing processes in the Charge Point.

 TODO: deze tekst naar de juiste plek verplaatsen:

   Inversely, if the connectorId is relevant but absent, this should be interpreted as “for all allowed connectorId values”. For example, a request for a statusNotification for connectorId 0 is a request for the status of the Charge Point. A request for a statusNotification without connectorId is a request for multiple statusNotifications: the notification for the Charge Point itself and a notification for each of its connectors.



[[terminology-and-conventions]]
== Terminology and Conventions

n/a

[[references]]
=== References

n/a


<<<
[[UseCases]]
== Trigger Message

===  H01 - Trigger Message

.H01 - Trigger Message
[cols="^1,3,12",options="header",]
|=======================================================================
|*No.*  | *Type* | *Description*
|*1*    | *Use case element name*  | Trigger Message
|*2*    | *ID*                     | H01
|       | _Functional block_       | H. Remote Trigger
|*3*    | *Objective(s)*           | To enable the Central System to request a Charge Point to send a Charge Point-initiated messages.
|*4*    | *Description*            | This use case describes the use of <<triggermessage.req,TriggerMessage.req>>. How a Central System can request a Charge Point to send Charge Point-initiated messages. In the request the Central System indicates which message it wishes to receive.
|       | _Actors_                 | Charge Point, Central System
|       | _Scenario description_   | *1.* The Central System sends <<triggermessage.req,TriggerMessage.req>> to the Charge Point. +
                                     *2.* The Charge Point responds with <<triggermessage.conf,TriggerMessage.conf>>, indicating whether it will send it or not, by returning _Accepted_, _Rejected_ or _NotImplemented_. +
                                     *3.* Message, requested by the Central System, that the Charge Point marked as _Accepted_, is being sent.
|       | _Alternative scenario(s)_  | n/a
|*5*    | *Prerequisite(s)*          | The Feature Profile _Remote Trigger_ is installed.
|*6*    | *Postcondition(s)*         | *Successful postconditions:* +
                                     The Central System _Successfully_ received all requested message. +
                                     +
                                     *Failure postconditions:* +
                                     The Central System has _not_ received the requested message.
|=======================================================================

.Sequence Diagram: Trigger Message
image::media/TriggerMessage.svg["Trigger Message",scaledwidth="50%",align="center"]
'''
.Sequence Diagram: Trigger Message Example
image::media/TriggerMessageExample.svg["Trigger Message Example",scaledwidth="70%",align="center"]

[cols="^1,3,12",options="noheader",]
|=======================================================================
|*7*    | *Error handling*         | n/a
|*8*    | *Remark(s)*                | The TriggerMessage mechanism is not intended to retrieve historic data. +
                                     +
                                     <<starttransaction.req,StartTransaction>> and <<stoptransaction.req,StopTransaction>> have been left out of this mechanism because they are not state related, but by their nature describe a transition. +
|=======================================================================

<<<
==== H01 - Requirements

_These requirements are normative._

.H01 - Requirements
[width="100%", cols="^1,^2,3,4,^1,2,2",options="header"]
|=======================================================================
|  *CP/CS* | *ID*    | *Precondition* | *Requirement definition*   | *M/O/C* | *Rationale* | *Note*
|  CS   | H01.FR.01 |      | In the request the Central System SHALL indicate which message(s) it wishes to receive.  | M  | |
|  CS   | H01.FR.02 | H01.FR.01. +
For every such requested message.     | The Central System MAY indicate to which Connector this request applies.   | O     | |
|       | H01.FR.03 | H01.FR.02                                                                                                                       | The requested message SHALL be leading. If the specified connectorId is not relevant to the message, it SHOULD be ignored. In such cases the requested message SHOULD still be sent. | C ||
|  CP   | H01.FR.05 |                                                                                                                       | The Charge Point SHALL first send the TriggerMessage response, before sending the requested message.  | M     |                                                                                                                                              |
|  CS   | H01.FR.06 | H01.FR.05                                                                                                    | In <<triggermessage.conf,TriggerMessage.conf>> the Charge Point SHALL indicate whether it will send it or not, by returning _Accepted_ or _Rejected_.            | M     |        | It is up to the Charge Point if it accepts or rejects the request to send.
|  CP   | H01.FR.07 | If the requested message is unknown or not implemented.                                                               | The Charge Point SHALL return _NotImplemented_. | M     |              |
|  CP   | H01.FR.08 |  | The TriggerMessage SHALL return the most recent measurements for all measurands configured in configuration key <<configkey-meter-values-sampled-data, `MeterValuesSampledData`>> | C | If a MeterValues message is triggered in this way.|
|  CP   | H01.FR.09 | If <<triggermessage.req,TriggerMessage.req>> is _not_ _Accepted_. | The Charge Point System SHALL respond with the status _Rejected_. | M ||
|  CP   | H01.FR.10 | If the Feature Profile _Remote Trigger_ is _NotImplemented_. | Upon receipt of <<triggermessage.req,TriggerMessage.req>>, the Charge Point SHALL respond with the status _NotImplemented_. | M ||
|  CP   | H01.FR.11 | | The messages it triggers SHOULD only give current information. | C | |
|  CP   | H01.FR.12 | |Messages that the Charge Point marks as _Accepted_ SHOULD be sent.| C || e.g. the situation could occur that, between accepting the request and actually sending the requested message, that same message gets sent because of normal operations. In such cases the message just sent MAY be considered as complying with the request.
|=======================================================================
